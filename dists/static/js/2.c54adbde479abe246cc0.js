webpackJsonp([2],{"4Bvr":function(t,e){},"5zde":function(t,e,s){s("zQR9"),s("qyJz"),t.exports=s("FeBl").Array.from},"7nRM":function(t,e,s){"use strict";e.__esModule=!0;var a,i=s("c/Tr"),o=(a=i)&&a.__esModule?a:{default:a};e.default=function(t){return Array.isArray(t)?t:(0,o.default)(t)}},PBjH:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("VsUZ"),i=s("/9V0"),o=s("Uv8r"),r={data:function(){return{cardsForm:{giftName:"",term:"",instructions:"",receiveInstructions:"",fileList:[],goodsList:[],sort:"",disabled:"false"}}},components:{vTitle:i.a,vCards:o.a},methods:{getCards:function(){var t=this;this.id=this.$route.params.id,this.axios.get(a.a.giftCard+"/"+this.id).then(function(e){200==e.status&&200==e.data.status?(console.log(e.data),t.$set(t.cardsForm,"giftName",e.data.result.giftName),t.$set(t.cardsForm,"fileList",e.data.result.fileList),t.$set(t.cardsForm,"goodsList",e.data.result.goodsList),t.$set(t.cardsForm,"instructions",e.data.result.instructions),t.$set(t.cardsForm,"receiveInstructions",e.data.result.receiveInstructions),t.$set(t.cardsForm,"sort",e.data.result.sort),t.$set(t.cardsForm,"term",e.data.result.term),t.$set(t.cardsForm,"disabled",e.data.result.disabled.toString()),t.id=e.data.result.id):"1000005"==e.data.code?t.$alert("提示",e.data.message,{confirmButtonText:"确定",callback:function(e){t.$router.push("/login")}}):t.$message.error(e.data.message)}).then(function(t){console.log(t)})}},created:function(){this.getCards()}},l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"create-rules"},[e("v-title",{attrs:{title:"编辑礼品卡"}}),this._v(" "),e("v-cards",{attrs:{cardsF:this.cardsForm,handleFn:"edit",id:this.id}})],1)},staticRenderFns:[]};var n=s("VU/8")(r,l,!1,function(t){s("4Bvr")},"data-v-1bcfb4d4",null);e.default=n.exports},Uv8r:function(t,e,s){"use strict";var a=s("Dd8w"),i=s.n(a),o=s("7nRM"),r=s.n(o),l=s("VsUZ"),n={props:["cardsF","handleFn","id"],data:function(){return{cardsForm:this.cardsF,optStatu:this.handleFn,dialogTableVisible:!1,goodsData:[],multipleSelection:[],isGoV:!1,getRowKeys:function(t){return t.id},pages:{currentPage:1,totalPages:5},rules:{giftName:[{required:!0,message:"请输入商品名字",trigger:"blur"}],fileList:[{required:!0,message:"请上传商品主图",trigger:"change"}],term:[{required:!0,validator:function(t,e,s){""==e?s(new Error("不可为空!")):/^[1-9]\d*$/.test(e)?s():s(new Error("必须为正整数!"))},trigger:"blur"}],sort:[{required:!1,validator:function(t,e,s){""==e?s():/^[1-9]\d*$/.test(e)?s():s(new Error("必须为正整数!"))},trigger:"blur"}],details:[{required:!0,message:"请输入商品详情",trigger:"change"}]}}},components:{},watch:{cardsForm:{handler:function(t,e){t.goodsList.length>0&&(this.multipleSelection=t.goodsList)},deep:!0}},methods:{indexMethod:function(t){return t+1},handleCurrentChange:function(t){this.getGoodsList(t)},handleSelectionChange:function(t){var e=this;this.multipleSelection=t,this.selectIds=[],t&&t.forEach(function(t){t&&e.selectIds.push(t.id)})},getGoodsList:function(t){var e=this;this.axios.post(l.a.goodsList,{pageIndex:t,pageSize:5}).then(function(t){200==t.status&&200==t.data.status?(e.$set(e.pages,"currentPage",t.data.result.pageIndex),e.$set(e.pages,"totalPages",t.data.result.pageTotal),t.data.result.result.forEach(function(t){t.disabled?t.disabledStr="下架":t.disabledStr="上架",t.fileList.length>0&&(t.url=t.fileList[0].url)}),e.goodsData=t.data.result.result):"1000005"==t.data.code?e.$alert("提示",t.data.message,{confirmButtonText:"确定",callback:function(t){e.$router.push("/login")}}):e.$message.error(t.data.message)}).then(function(t){console.log(t)}),this.toggleSelection(this.multipleSelection)},openGoodsBox:function(){this.dialogTableVisible=!0,this.getGoodsList(1)},closeGoodsBox:function(){this.dialogTableVisible=!1,console.log(this.multipleSelection)},doDelGoods:function(t){var e=r()(this.multipleSelection).slice(0);console.log(e),this.multipleSelection.forEach(function(s,a){t.id==s.id&&e.splice(a,1)}),this.multipleSelection=e},toggleSelection:function(t){var e=this;this.goodsData.forEach(function(s){var a=!1;t.forEach(function(t){s.id==t.id&&(a=!0)}),a?e.$refs.multipleTable.toggleRowSelection(s,!0):e.$refs.multipleTable.toggleRowSelection(s,!1)})},handleRemove:function(t,e){this.$set(this.cardsForm,"fileList",e)},handleExceed:function(t,e){this.$message.warning("当前限制选择 1 个文件，本次选择了 "+t.length+" 个文件，共选择了 "+(t.length+e.length)+" 个文件")},handleUpload:function(t){var e=this;this.file=t;var s=new FormData;return s.append("file",this.file),s.append("type",1),this.axios({method:"post",url:l.a.upload,data:s,headers:{"Content-Type":"multipart/form-data"}}).then(function(t){if(200==t.status&&200==t.data.status){var s=e.cardsForm.fileList;s.push(t.data.result),e.$set(e.cardsForm,"fileList",s)}else"1000005"==t.data.code?e.$router.push("/login"):e.$message.error(t.data.message)}).then(function(t){console.log(t)}),!1},submitForm:function(t){var e=this;this.isGoV=!0,this.cardsForm.goodsList=this.multipleSelection,this.multipleSelection.length<1||(console.log(this.cardsForm),this.$refs[t].validate(function(t){if(!t)return!1;if("add"==e.optStatu)console.log("add"),e.addCards(e.cardsForm);else if("edit"==e.optStatu){var s=i()({},e.cardsForm,{id:e.id});e.editCards(s),console.log("edit")}}))},addCards:function(t){var e=this;this.axios.post(l.a.giftCard,t).then(function(t){200==t.status&&200==t.data.status&&1==t.data.result?e.$alert("提示","操作成功，返回列表",{confirmButtonText:"确定",callback:function(t){e.$router.back()}}):"1000005"==t.data.code?e.$alert("提示",t.data.message,{confirmButtonText:"确定",callback:function(t){e.$router.push("/login")}}):e.$message.error(t.data.message)}).then(function(t){console.log(t)})},editCards:function(t){var e=this;this.axios.put(l.a.giftCard,t).then(function(t){200==t.status&&200==t.data.status&&1==t.data.result?e.$alert("提示","操作成功，返回列表",{confirmButtonText:"确定",callback:function(t){e.$router.back()}}):"1000005"==t.data.code?e.$alert("提示",t.data.message,{confirmButtonText:"确定",callback:function(t){e.$router.push("/login")}}):e.$message.error(t.data.message)}).then(function(t){console.log(t)})},backCards:function(){this.$router.back()}},created:function(){},mounted:function(){}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"change-cards"},[s("el-form",{ref:"cardsForm",staticClass:"from",attrs:{model:t.cardsForm,rules:t.rules,"label-width":"200px"}},[s("el-form-item",{attrs:{label:"礼品卡名称：",prop:"giftName"}},[s("el-input",{staticClass:"ipt",attrs:{size:"medium",placeholder:"请输入"},model:{value:t.cardsForm.giftName,callback:function(e){t.$set(t.cardsForm,"giftName",e)},expression:"cardsForm.giftName"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"礼品卡卡面：",prop:"fileList"}},[s("el-upload",{staticClass:"ipt",attrs:{action:"","list-type":"picture","file-list":t.cardsForm.fileList,limit:3,"before-upload":t.handleUpload,"on-remove":t.handleRemove,"on-exceed":t.handleExceed}},[s("el-button",{attrs:{size:"small",type:"success"}},[t._v("点击上传")]),t._v(" "),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb，1-6张")])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"有效期：",prop:"term"}},[s("el-input",{staticClass:"ipt",attrs:{size:"medium",placeholder:"请输入"},model:{value:t.cardsForm.term,callback:function(e){t.$set(t.cardsForm,"term",e)},expression:"cardsForm.term"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"排序：",prop:"sort"}},[s("el-input",{staticClass:"ipt",attrs:{size:"medium",placeholder:"请输入"},model:{value:t.cardsForm.sort,callback:function(e){t.$set(t.cardsForm,"sort",e)},expression:"cardsForm.sort"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"添加商品：",prop:"goodsList"}},[s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){t.openGoodsBox()}}},[t._v("相关商品")]),t._v(" "),t.multipleSelection.length>0?s("el-row",{staticClass:"goods-list",attrs:{type:"flex"}},t._l(t.multipleSelection,function(e){return s("el-col",{key:e.id,staticClass:"goods-box",attrs:{span:6}},[s("div",{staticClass:"gb-card"},[s("img",{staticClass:"gb-image",attrs:{src:e.fileList[0].url}}),t._v(" "),s("div",{staticClass:"gb-info"},[s("span",[t._v(t._s(e.goodsName))]),t._v(" "),s("div",[s("el-button",{staticClass:"gb-btn",on:{click:function(s){t.doDelGoods(e)}}},[t._v("删除")])],1)])])])})):t._e(),t._v(" "),t.multipleSelection.length<1&&t.isGoV?s("p",{staticClass:"err-tip"},[t._v("请选择商品！ ")]):t._e()],1),t._v(" "),s("el-form-item",{attrs:{label:"领取页面使用说明：",prop:"instructions"}},[s("el-input",{staticClass:"ipt",attrs:{type:"textarea",autosize:{minRows:3,maxRows:7},placeholder:"请输入"},model:{value:t.cardsForm.instructions,callback:function(e){t.$set(t.cardsForm,"instructions",e)},expression:"cardsForm.instructions"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"领取成功页面使用说明：",prop:"receiveInstructions"}},[s("el-input",{staticClass:"ipt",attrs:{type:"textarea",autosize:{minRows:3,maxRows:7},placeholder:"请输入"},model:{value:t.cardsForm.receiveInstructions,callback:function(e){t.$set(t.cardsForm,"receiveInstructions",e)},expression:"cardsForm.receiveInstructions"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"状态：",prop:"disabled"}},[s("el-radio-group",{model:{value:t.cardsForm.disabled,callback:function(e){t.$set(t.cardsForm,"disabled",e)},expression:"cardsForm.disabled"}},[s("el-radio",{attrs:{label:"false"}},[t._v("启用")]),t._v(" "),s("el-radio",{attrs:{label:"true"}},[t._v("禁用")])],1)],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("cardsForm")}}},[t._v("保存")]),t._v(" "),s("el-button",{on:{click:function(e){t.backCards()}}},[t._v("返回")])],1)],1),t._v(" "),s("el-dialog",{staticClass:"goods-dialog",attrs:{title:"商品列表",visible:t.dialogTableVisible,width:"70%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[s("el-table",{ref:"multipleTable",attrs:{data:t.goodsData,"row-key":t.getRowKeys},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":!0},model:{value:t.multipleSelection,callback:function(e){t.multipleSelection=e},expression:"multipleSelection"}}),t._v(" "),s("el-table-column",{attrs:{label:"编号",width:"80",align:"center",type:"index",index:t.indexMethod}}),t._v(" "),s("el-table-column",{attrs:{label:"商品主图",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("img",{staticClass:"tab-img",attrs:{src:t.row.url}})]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"goodsName",label:"商品名称",width:"150"}}),t._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",width:"200"}}),t._v(" "),s("el-table-column",{attrs:{prop:"price",label:"价格",width:"200"}}),t._v(" "),s("el-table-column",{attrs:{prop:"disabledStr",label:"状态",width:"200"}})],1),t._v(" "),s("div",{staticClass:"pagination-wrap"},[s("el-pagination",{attrs:{"current-page":t.pages.currentPage,"page-size":5,layout:"prev, pager, next, jumper","page-count":t.pages.totalPages},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.pages,"currentPage",e)}}})],1),t._v(" "),s("div",{staticClass:"close-box"},[s("el-button",{on:{click:function(e){t.closeGoodsBox()}}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]};var d=s("VU/8")(n,c,!1,function(t){s("xLH+")},"data-v-7c3cccfb",null);e.a=d.exports},"c/Tr":function(t,e,s){t.exports={default:s("5zde"),__esModule:!0}},fBQ2:function(t,e,s){"use strict";var a=s("evD5"),i=s("X8DO");t.exports=function(t,e,s){e in t?a.f(t,e,i(0,s)):t[e]=s}},qyJz:function(t,e,s){"use strict";var a=s("+ZMJ"),i=s("kM2E"),o=s("sB3e"),r=s("msXi"),l=s("Mhyx"),n=s("QRG4"),c=s("fBQ2"),d=s("3fs2");i(i.S+i.F*!s("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,s,i,u,m=o(t),f="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,h=void 0!==g,v=0,b=d(m);if(h&&(g=a(g,p>2?arguments[2]:void 0,2)),void 0==b||f==Array&&l(b))for(s=new f(e=n(m.length));e>v;v++)c(s,v,h?g(m[v],v):m[v]);else for(u=b.call(m),s=new f;!(i=u.next()).done;v++)c(s,v,h?r(u,g,[i.value,v],!0):i.value);return s.length=v,s}})},"xLH+":function(t,e){}});
//# sourceMappingURL=2.c54adbde479abe246cc0.js.map